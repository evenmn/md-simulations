<!--
Automatically generated HTML file from DocOnce source
(https://github.com/hplgit/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/hplgit/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="The Water Project">

<title>The Water Project</title>


<style type="text/css">
/* blueish style */

/* Color definitions:  http://www.december.com/html/spec/color0.html
   CSS examples:       http://www.w3schools.com/css/css_examples.asp */

body {
  margin-top: 1.0em;
  background-color: #ffffff;
  font-family: Helvetica, Arial, FreeSans, san-serif;
  color: #000000;
}
h1 { font-size: 1.8em; color: #1e36ce; }
h2 { font-size: 1.6em; color: #1e36ce; }
h3 { font-size: 1.4em; color: #1e36ce; }
a { color: #1e36ce; text-decoration:none; }
tt { font-family: "Courier New", Courier; }
/* pre style removed because it will interfer with pygments */
p { text-indent: 0px; }
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-style: normal; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}

div { text-align: justify; text-justify: inter-word; }
</style>


</head>

<!-- tocinfo
{'highest level': 1,
 'sections': [('Table of contents',
               1,
               'table_of_contents',
               'table_of_contents'),
              ('Introduction', 1, None, '___sec0'),
              ('Packing Water', 1, 'sec:packingwater', 'sec:packingwater'),
              ('Find correct volume', 2, None, '___sec2'),
              ('Generate Packmol input script', 2, None, '___sec3'),
              ('Run Packmol', 2, None, '___sec4'),
              ('Convert to LAMMPS-friendly format', 2, None, '___sec5'),
              ('The Vashishta Potential', 1, None, '___sec6'),
              ('The original Vashishta potential', 2, None, '___sec7'),
              ('The two-body term', 3, None, '___sec8'),
              ('The three-body term', 3, None, '___sec9'),
              ('The Branicio formulation of the Vashishta potential',
               2,
               None,
               '___sec10'),
              ('The two-body term', 3, None, '___sec11'),
              ('The three-body term', 3, None, '___sec12'),
              ('Water Parameters', 1, None, '___sec13'),
              ('Run LAMMPS with selected parameters', 2, None, '___sec14'),
              ('Setting parameters', 3, None, '___sec15'),
              ('Generate parameter file', 3, None, '___sec16'),
              ('Run LAMMPS simulation', 3, None, '___sec17'),
              ('The relative charge of Hydrogen', 2, None, '___sec18')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- ------------------- main content ---------------------- -->



<center><h1>The Water Project</h1></center>  <!-- document title -->

<p>
<!-- author(s): Even Marius Nordhagen -->

<center>
<b>Even Marius Nordhagen</b> 
</center>

<p>
<!-- institution(s) -->

<br>
<p>
<center><h4>Feb 17, 2020</h4></center> <!-- date -->
<br>

<h1 id="table_of_contents">Table of contents</h2>

<p>
<a href="#___sec0"> Introduction </a><br>
<a href="#sec:packingwater"> Packing Water </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec2"> Find correct volume </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec3"> Generate Packmol input script </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec4"> Run Packmol </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec5"> Convert to LAMMPS-friendly format </a><br>
<a href="#___sec6"> The Vashishta Potential </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec7"> The original Vashishta potential </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec10"> The Branicio formulation of the Vashishta potential </a><br>
<a href="#___sec13"> Water Parameters </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec14"> Run LAMMPS with selected parameters </a><br>
&nbsp; &nbsp; &nbsp; <a href="#___sec18"> The relative charge of Hydrogen </a><br>
</p>

<h1 id="___sec0">Introduction </h1>
Water is a substance that is found everywhere on earth, and is a fundamental requirement for life to occur the way we know it. Therefore, knowledge of water is important both on microscopic and the macroscopic scales. Despite this, general inter-atomic water potentials are often unavailable. The most popular water potentials are tailored in order to model specific properties of water, and if we use the potential to study other properties they will not work.

<p>
The complexity of water is what makes it hard to find flexible potentials. The water molecules are not static, the distance between the atoms and the three-body angle changes with time, and occasionally OH&nbsp;\( ^- \)-groups and H&nbsp;\( _3 \)&nbsp;O&nbsp;\( ^+ \)-groups will occur. Therefore, a realistic water potential does not model the water molecule as a static object, but instead it should set up an inter-atomic potential between all the atoms, based on charge interaction, dipole-dipole-interaction, van der Vaals interactions and so on.

<p>
The Vashishta potential is an inter-atomic potential developed by Vashishta et al. at the University of Southern California. It is very flexible, and has shown impressive power as silica potential (Vashishta, 1990), SiC potential (Vashishta, 2007) and InP potential (Branicio, 2009). We aim to tweak the parameters in the potential such that the water behaves realistic under 1 atm pressure.

<p>
<!-- !split -->

<h1 id="sec:packingwater">Packing Water</h1>

<p>
Before we can start a simulation, we need to pack water. This should be done wisely, as an unphysical initial water bulk will give unphysical results. Firstly, it is important to pack the water with the correct density. The water density at 1 atm pressure and 300K is 0.9966 g/cm&nbsp;\( ^3 \). Secondly, it is important that the spacing between molecules are appropriate, in order to start with a realistic potential energy.

<h2 id="___sec2">Find correct volume </h2>
We will use the Packmol package to pack water. It packs the water in a cubic box, and takes the length of the sides of the box as an input. The first thing we need to do, is therefore to find the length of the box side at a given density. The class <code>WaterPack</code> found in <code>python/pack_water.py</code> contains a function for this, and the length can be found from

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">pack_water</span> <span style="color: #008000; font-weight: bold">import</span> WaterPack

number <span style="color: #666666">=</span> <span style="color: #666666">2000</span>       <span style="color: #408080; font-style: italic"># Number of water molecules</span>
density <span style="color: #666666">=</span> <span style="color: #666666">0.9966</span>    <span style="color: #408080; font-style: italic"># Density of water at 25°C and 1atm</span>

packer <span style="color: #666666">=</span> WaterPack(number)
length <span style="color: #666666">=</span> packer<span style="color: #666666">.</span>den2len(density)        <span style="color: #408080; font-style: italic"># Length of box in [Å]</span>
</pre></div>

<h2 id="___sec3">Generate Packmol input script </h2>
Thereafter, we would like to generate a Packmol input script, based on the volume of the cubic box and the number of molecules. This is done by

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>packer<span style="color: #666666">.</span>packmol_gen(pbc<span style="color: #666666">=1.0</span>)
</pre></div>
<p>
The argument <code>pbc=1.0</code> is added to have an appropriate spacing between the molecules also at the boundaries.

<h2 id="___sec4">Run Packmol </h2>
We are now ready to run Packmol and generate the positions of all the atoms. Simply run

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>packer<span style="color: #666666">.</span>packmol_run()
</pre></div>
<p>
PS: This requires that the Packmol package is installed correctly. See <a href="http://m3g.iqm.unicamp.br/packmol/home.shtml" target="_self">the Packmol webpage</a>.

<h2 id="___sec5">Convert to LAMMPS-friendly format </h2>
The file generated by Packmol is on XYZ-format, which LAMMPS does not support. To convert the file to a LAMMPS-friendly file, run

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>read_data <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;data/water_lmps.data&quot;</span>
packer<span style="color: #666666">.</span>xyz2lmp(read_data)
</pre></div>
<p>
Now we finally have a realistic initial water configuration. It is presented in figures <a href="#fig:front">1</a> and <a href="#fig:perspective">2</a>.

<p>
<center> <!-- figure label: --> <div id="fig:front"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 1:  Initial configuration of water, seen from the front.  <!-- caption label: fig:front --> </p></center>
<p><img src="fig/initial_config_front.png" align="bottom" width=500></p>
</center>

<p>
<center> <!-- figure label: --> <div id="fig:perspective"></div> <!-- FIGURE -->
<hr class="figure">
<center><p class="caption">Figure 2:  Initial configuration of water, seen from perspective.  <!-- caption label: fig:perspective --> </p></center>
<p><img src="fig/initial_config_perspective.png" align="bottom" width=500></p>
</center>

<p>
<!-- !split -->

<h1 id="___sec6">The Vashishta Potential </h1>
The Vashishta potential (Vashishta, 1990) consists of a two-body and a three-body term, and describes effects like steric repulsion, Coulomb interaction, charge-dipole interaction, van der Waals interaction, and covalent bond bending and stretching. It has proven to be able to model fundamental features in silica and water, and is today the <b>de facto</b> standard potential for modeling the molecular behavior of the substances.

<h2 id="___sec7">The original Vashishta potential </h2>
The original Vashishta potential was introduced by Vashishta et al. in 1990, and was made to model AX&nbsp;\( _2 \)-type glasses (like SiO&nbsp;\( _2 \)). It takes the form
$$
V = \sum_{i < j}^NV^{(2)}(r_{ij})+\sum_{i < j < k}^NV^{(3)}(r_{ij},r_{jk},r_{ik}),
$$

where \( r_{ij}=|\boldsymbol{r}_{i}-\boldsymbol{r}_{j}| \) is the relative distance between particle \( i \) and \( j \). The first term is the two-body term, and the second term is the three-body term.

<h3 id="___sec8">The two-body term </h3>

The two-body term reads
$$
V_{ij}^{(2)}(r)=\underbrace{\frac{H_{ij}}{r^{\eta_{ij}}}}_{\text{steric repulsion}}+\underbrace{\frac{Z_iZ_j}{r}}_{\text{Coulomb interaction}}-\underbrace{\frac{\alpha_iZ_j^2+\alpha_jZ_i^2}{2r^4}e^{r/r_{4s}}}_{\text{charge dipole interaction}}.
$$

<p>
Here we have five variational parameters:

<ul>
<li> \( H_{ij} \) - strength of steric interaction</li>
<li> \( \eta_{ij} \) - exponent of steric repulsion</li>
<li> \( Z_i \) - charge of i-th ion</li>
<li> \( \alpha_i \) - electronic polarizability of the i-th ion</li>
<li> \( r_{4s} \) - decay length \( \rightarrow \) 4.43&#197;</li>
</ul>

<h3 id="___sec9">The three-body term </h3>

The three-body term reads
$$
V_{ijk}^{(3)}=\underbrace{B_{ijk}}_{\text{strength}}\underbrace{f(r_{ij},r_{ik})}_{\text{bond stretching}}\underbrace{p(\theta_{jik}\overline{\theta}_{jik})}_{\text{bond bending}},
$$

with
$$
f(r_{ij},r_{ik})=
\begin{cases}
    \exp(\frac{l}{r_{ij}-r_0}-\frac{l}{r_{ik}-r_0})\qquad\text{if}\quad &r_{ij},r_{ik}< r_0\\
    0 &r_{ij},r_{ik}>r_0,
\end{cases}
$$

and
$$
p(\theta_{jik},\overline{\theta}_{jik})=(\cos(\theta_{jik})-\cos(\overline{\theta}_{jik}))^2.
$$

<p>
Here we have four additional variational parameters:

<ul>
<li> \( r_0 \) - cutoff distance for the three-body interaction</li>
<li> \( l \) - exponent of bond stretching</li>
<li> \( \overline{\theta} \) - equilibrium angle</li>
<li> \( B \) - strength of three-body correlations</li>
</ul>

So in total, the potential takes nine parameters that need to be set carefully in order to get a realistic potential.

<h2 id="___sec10">The Branicio formulation of the Vashishta potential </h2>
The Vashishta potential was improved by Branicio et al. in 2009, adding support for the van der Waals interactions and screened Coulomb interaction. This is the Vashishta potential implemented in LAMMPS.

<h3 id="___sec11">The two-body term </h3>

The improved two-body interaction reads
$$
V_{ij}^{(2)}(r)=\frac{H_{ij}}{r^{\eta_{ij}}}+\frac{Z_iZ_j}{r}e^{-r/\lambda_1}-\frac{D_{ij}}{r^4}e^{-r/\lambda_4}-\frac{w_{ij}}{r^6},
$$

where
$$
H_{ij}=A(\sigma_i-\sigma_j)^{\eta_{ij}},
$$

and
$$
D_{ij}=\frac{\alpha_iZ_j^2+\alpha_jZ_i^2}{2}.
$$

<p>
This two-body term has eight variational parameters:

<ul>
<li> \( \eta_{ij} \) - exponent of steric repulsion</li>
<li> \( Z_i \) - charge of i-th ion</li>
<li> \( A \) - strength of steric repulsion</li>
<li> \( \sigma_i \) -</li> 
<li> \( \alpha_i \) - electronic polarizability of the i-th ion</li>
<li> \( \lambda_1 \) - Coulomb screening strength</li>
<li> \( \lambda_4 \) - decay length \( \rightarrow \) 4.43&#197;</li>
<li> \( w_{ij} \) - van der Waals strength</li>
</ul>

<h3 id="___sec12">The three-body term </h3>

The three-body term reads
$$
V_{ijk}^{(3)}=\Gamma(r_{ij},r_{ik})\Lambda(\theta_{jik}),
$$

with 
$$
\Gamma(r_{ij},r_{ik})=B_{jik}\exp(\frac{\gamma}{r_{ij}-r_0}+\frac{\gamma}{r_{ik}-r_0})\Theta(r_0-r_{ij})\Theta(r_0-r_{ik}),
$$

$$
\Theta(x)=
\begin{cases}
    1\qquad\text{if}\quad & x\leq 0\\
    0\qquad\text{if}\quad & x>0,
\end{cases}
$$

$$
\Lambda(\theta_{jik})=\frac{(\cos(\theta_{jik})-\cos(\theta_{0}))^2}{1+C(\cos(\theta_{jik})-\cos(\theta_0))^2}.
$$

<p>
Here, we again have five variational parameters:

<ul>
<li> \( r_0 \) - cutoff distance for the three-body interaction</li>
<li> \( \gamma \) - exponent of bond stretching</li>
<li> \( \theta_0 \) - equilibrium angle</li>
<li> \( B \) - strength of three-body correlations</li>
<li> \( C \) - denominator factor</li>
</ul>

<!-- !split -->

<h1 id="___sec13">Water Parameters </h1>
The Vashishta potential is a three-body potential, and in LAMMPS we need to specify the three-body interactions between all possible three-body objects. For water, this means the objects H-H-H, O-O-O, H-O-H, O-H-O, H-H-O, O-H-H, O-O-H and H-O-O. By recalling that there are 14 variational parameters for each object, we have a large set of parameters to specify. However, the only molecules and ions that we will get are H&nbsp;\( _2 \), O&nbsp;\( _2 \), H&nbsp;$_2$O and OH&nbsp;\( ^- \). In other words, only the first four objects will contribute, meaning that all parameters related to the last four objects can be set to zero (but they still need to be identified in the parameter file). Moreover, the H&nbsp;\( _2 \), O&nbsp;\( _2 \) and OH&nbsp;\( ^- \) molecules are obviously affected by two-body interactions only, and the three-body parameters can be set to zero. After this, we are left with 35 independent parameters that need to be found. Still a lot of parameters, making a grid-search impossible.

<h2 id="___sec14">Run LAMMPS with selected parameters </h2>
We have developed a system making it easy to run LAMMPS with the preferred parameters. The class is named <code>AutoSim</code> and is found in <code>python/lammps_simulator.py</code>. It is based on a three-step procedure:
1. Set parameters. Parameters that are not specified are set to the default parameters, suggested by Wang et al.
2. Generate the parameter file
3. Run simulation

<h3 id="___sec15">Setting parameters </h3>

To change the relative charge of Hydrogen to \( Z_H = 0.5 \), simply run the following script:

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">lammps_simulator</span> <span style="color: #008000; font-weight: bold">import</span> AutoSim
sim <span style="color: #666666">=</span> AutoSim(<span style="color: #BA2121">&quot;water&quot;</span>)

Z_H <span style="color: #666666">=</span> <span style="color: #666666">0.5</span>
Z_O <span style="color: #666666">=</span> <span style="color: #666666">-</span> <span style="color: #666666">2</span> <span style="color: #666666">*</span> Z_H
params <span style="color: #666666">=</span> {<span style="color: #BA2121">&quot;HHH&quot;</span> : {<span style="color: #BA2121">&quot;Zi&quot;</span> : Z_H, <span style="color: #BA2121">&quot;Zj&quot;</span> : Z_H},
          <span style="color: #BA2121">&quot;OOO&quot;</span> : {<span style="color: #BA2121">&quot;Zi&quot;</span> : Z_O, <span style="color: #BA2121">&quot;Zj&quot;</span> : Z_O},
          <span style="color: #BA2121">&quot;OHH&quot;</span> : {<span style="color: #BA2121">&quot;Zi&quot;</span> : Z_O, <span style="color: #BA2121">&quot;Zj&quot;</span> : Z_H},
          <span style="color: #BA2121">&quot;HOO&quot;</span> : {<span style="color: #BA2121">&quot;Zi&quot;</span> : Z_H, <span style="color: #BA2121">&quot;Zj&quot;</span> : Z_O}}
sim<span style="color: #666666">.</span>set_parameters(params)
</pre></div>

<h3 id="___sec16">Generate parameter file </h3>

To generate a readable parameter file for LAMMPS, run

<p>

<!-- code=python (!bc python) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>sim<span style="color: #666666">.</span>generate_parameter_file(filename<span style="color: #666666">=</span><span style="color: #BA2121">&quot;data/H2O.vashishta&quot;</span>)
</pre></div>

<h3 id="___sec17">Run LAMMPS simulation </h3>

The last step is to run the actual simulation, given a parameter file and an initial water configuration found by the script presented in <a href="#sec:packingwater">Packing Water</a>. The LAMMPS executable and the output file path should also be given:

<p>

<!-- code=text typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>read_data = &quot;data/water_lmps.data&quot;
lammps_exec = &quot;lmp_serial&quot;
path = &quot;data/&quot;

sim.simulate(read_data=read_data, lammps_exec=lammps_exec, path=path)
</pre></div>

<h2 id="___sec18">The relative charge of Hydrogen </h2>
In a water molecule, the attraction from the Oxygen atom on the electrons are stronger than the attraction from the Hydrogen atoms on the electrons. This means that each atom is no longer neutral, giving the atoms relative charges. The Oxygen atom will be negatively charged, while the Hydrogen atom will have a positive charge. The molecule, on the other hand, is still neutral, making the relative charge of Oxygen, \( Z_O \), and the relative charge of Hydrogen, \( Z_H \), dependent on each other in the following way:
$$
Z_O=-2Z_H
$$

Exactly what the relative charges should be in our model is hard to say, 

<!-- ------------------- end of main content --------------- -->


</body>
</html>
    

